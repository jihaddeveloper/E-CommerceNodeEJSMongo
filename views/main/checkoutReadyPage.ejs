<% layout('layoutPage') -%>

<div class="container">

    <% if(cart) { %>
    <h1 class="page-title">Cart Items</h1>
    <table class="table table-striped alignmiddle">
        <tr>
            <th>Image</th>
            <th>Title</th>
            <th>Quantity</th>
            <th>Unit Price</th>
            <th>Actions</th>
            <th>Subtotal</th>
        </tr>
        <% var total = 0; %>
        <% for(var i = 0; i < cart.length; i++) { %>
        <% var subtotal = parseFloat(cart[i].unitPrice * cart[i].quantity) %>
        <% var total = (total) + (subtotal) %>
        <tr>
            <td><img class="product-image" style="width: 20%; height: 20%;" src="data:image/png;base64, <%= cart[i].image %>"></td>
            <td>
                <%= cart[i].title %>
            </td>
            <td>
                <%= cart[i].quantity %>
            </td>
            <td>
                <%= cart[i].unitPrice %>
            </td>
            <td>
                <li style="display:inline;"><a href="/cart/update/<%= cart[i].title %>?action=increase"><b>(+)</b></a>&nbsp;</li>
                <li style="display:inline;"><a href="/cart/update/<%= cart[i].title %>?action=decrease"><b>(-)</b></a>&nbsp;</li>
                <li style="display:inline;"> <a href="/cart/update/<%= cart[i].title %>?action=remove">(x)</a>&nbsp;</li>
            </td>
            <td>
                <%= subtotal %>
            </td>
        </tr>

        <% } %>
        <tr>
            <td colspan="6" style="text-align:right;"><b>Total:
                    <%= total %></b></td>
        </tr>
        <tr>
            <td colspan="7" style="text-align:center">
                <a class="clearcart btn btn-danger" href="/clear">Clear Cart</a>
                <a class="btn btn-success" href="/">Continue Shopping</a>
                <a class="btn btn-primary" href="/stripe-payment">Confirm Order</a>
            </td>
        </tr>
    </table>
    <% } else { %>
    <h3 class="text-center">Your Cart is empty</h3>
    <% } %>

</div>